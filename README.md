# Java-plus-graduation (Приложение-афиша)
Позволяет пользователям делиться информацией об интересных мероприятиях и находить компанию для участия в этих мероприятиях.

## Описания сервисов
### 1) core (сервисы, выделенные из главного main-service):
- а) user-service - администрирование пользователей.
- b) event-service - управление мероприятиями (также содержит логику работы с комментариями о мероприятиях).
- c) request-service - управление заявками на участие в мероприятиях.
- d) category-service - управление категориями мероприятий.

## Взаимодействия между сервисами
### 1) user-service
- автономен, не использует логику прочих сервисов.
### 2) event-service
- a) user-service: получение информации об авторах мероприятий.
- b) request-service: получений количества запросов на участие в мероприятиях и подробной информации о каждом из них.
- c) category-service: получение информации о категории конкретного мероприятия.
### 3) request-service
- a) user-service: работа с полем, содержащим информацию о пользователе, создавшем запрос (requesterId).
- b) event-service: работа с полем, содержащим информацию о мероприятии, в котором запрашивается участие (eventId). 
### 4) category-service
- a) event-service: получение всех мероприятий, относящихся к конкретной категории.

## Конфигурация сервисов
- За конфигурирование сервисов отвечает модуль [config-server](/infra/config-server).  
- Конфигурация осуществлена при помощи Spring-cloud-config.
- Файлы конфигурации (application.yaml) расположены в [ресурсах модулях конфигурации](/infra/config-server/src/main/resources).

## [Ссылка на внешнее API](/ewm-main-service-spec.json)

## Внутреннее API:
- [Ссылка на внутренне API](/ewm-stats-service-spec.json)
- [Feign-клиенты, содержащие методы внутреннего API с их подробными описаниями](core/common-module/src/main/java/ru/practicum/client)



# Избранная к реализация фича - Работа с комментариями
## Описание 
Комментарии могут содержать текст объемом до 1000 символов, 
могут быть оставлены пользователями имеющими подтвержденную 
заявку на участие в подтвержденном мероприятии.

Создавать комментарий может подтвержденный пользователь не являющийся автором мероприятия.
Редактирование\удаление доступно только автору комментария.

Каждый комментарий проходит модерацию в админ секции перед публикацией. В случае редактирования, модерация повторяется.

## Endpoints
добавленные пути расположены в private и admin секциях приложения
### PRIVATE секция 
#### Создание комментария 
```
POST {baseUrl}/users/{userId}/comments?eventId={eventId}
```
Пример отправляемых данных:
```json
{
  "text": "example text comment"
}
```
Условия валидации: 

строка не пустая, ивент подтвержден,
юзер не автор ивента, юзер имеет подтвержденную заявку на ивент


#### Редактирование комментария
```
PATCH {baseUrl}/users/{userId}/comments/{commentId}
```
Пример отправляемых данных:
```json
{
  "text": "example text comment"
}
```
Условия валидации:

строка не пустая, юзер автор комментария

#### Удаление комментария
```
DELETE {baseUrl}/users/{userId}/comments/{commentId}
```
Условия валидации:

юзер автор комментария

### ADMIN секция
#### Просмотр списка коментариев ожидающих валидации
```
GET {baseUrl}/admin/comments
```

#### Одобрение\Отклонение ожидающего валидации комментария
```
PATCH {baseUrl}/admin/comments/{commentId}
```
Пример отправляемых данных:
```json
{
  "action": "PUBLISH_COMMENT"
}
```
### PUBLIC секция
входит в вывод связанного event в виде коллекции опубликованных комментариев
Пример вывода в коллекции комментариев:
```json
{
  "id": 1,
  "text": "example text comment",
  "eventId": 1,
  "authorId": 1,
  "created": "yyyy-MM-dd HH:mm:ss",
  "status": "PUBLISHED"
}
```